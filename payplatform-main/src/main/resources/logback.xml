<?xml version="1.0" encoding="UTF-8"?>

<!--java -Dlogback.configurationFile=/path/to/config.xml chapters.configuration.MyApp1-->

<configuration scan="true" scanPeriod="10 seconds">

    <!--<insertFromJNDI env-entry-name="java:comp/env/appName" as="appName" />
    <contextName>${appName}</contextName>-->

    <property name="LOG_PATH" value="./log"/>
    <property name="APP_NAME" value="appserver"/>
    <!--<property file="src/main/java/chapters/configuration/variables1.properties" />-->
    <!--<property resource="resource1.properties" />-->

    <contextName>${APP_NAME}</contextName>

    <appender name="FILE" class="ch.qos.logback.core.rolling.RollingFileAppender">
        <rollingPolicy class="ch.qos.logback.core.rolling.TimeBasedRollingPolicy">
            <FileNamePattern>${LOG_PATH}/%d{yyyy-MM-dd}/${APP_NAME}.%d{yyyy-MM-dd}.log</FileNamePattern>
        </rollingPolicy>
        <encoder>
            <pattern>%d{HH:mm:ss.SSS} %contextName [%thread] %-5level %logger{36} - %msg%n</pattern>
        </encoder>
    </appender>

    <appender name="ERROR_LOG" class="ch.qos.logback.core.rolling.RollingFileAppender">
        <rollingPolicy class="ch.qos.logback.core.rolling.TimeBasedRollingPolicy">
            <FileNamePattern>${LOG_PATH}/%d{yyyy-MM-dd}/${APP_NAME}.%d{yyyy-MM-dd}.error.log</FileNamePattern>
        </rollingPolicy>
        <encoder>
            <pattern>%d{HH:mm:ss.SSS} %contextName [%thread] %-5level %logger{36} - %msg%n</pattern>
        </encoder>
    </appender>

    <appender name="VISIT_LOG" class="ch.qos.logback.core.rolling.RollingFileAppender">
        <rollingPolicy class="ch.qos.logback.core.rolling.TimeBasedRollingPolicy">
            <FileNamePattern>${LOG_PATH}/%d{yyyy-MM-dd}/${APP_NAME}.%d{yyyy-MM-dd}.visit.log</FileNamePattern>
        </rollingPolicy>
        <encoder>
            <pattern>%d{HH:mm:ss.SSS} %contextName [%thread] - %msg%n</pattern>
        </encoder>
    </appender>

    <!--   <appender name="DB" class="ch.qos.logback.classic.db.DBAppender">
           <connectionSource class="ch.qos.logback.core.db.DriverManagerConnectionSource">
               <driverClass>oracle.jdbc.OracleDriver</driverClass>
               <url>jdbc:oracle:thin:@10.164.193.106:1521/app</url>
               <user>appserverlog</user>
               <password>appserverlog123</password>
           </connectionSource>
       </appender>-->

    <!-- 使用连接池的配置，缺少jar包 -->
    <!--    <appender name="VISIT_LOG_DB" class="ch.qos.logback.classic.db.DBAppender">
            <connectionSource class="ch.qos.logback.core.db.DataSourceConnectionSource">
                <dataSource class="com.mchange.v2.c3p0.ComboPooledDataSource">
                    <driverClass>oracle.jdbc.OracleDriver</driverClass>
                    <sqlDialect class="ch.qos.logback.core.db.dialect.OracleDialect"/>
                    <url>jdbc:oracle:thin:@10.164.194.168:1521/haiercash</url>
                    <user>appserver</user>
                    <password>123456</password>
                </dataSource>
            </connectionSource>
        </appender>-->
    <!-- 不使用连接池的配置 -->
    <!--    <appender name="VISIT_LOG_DB" class="ch.qos.logback.classic.db.DBAppender">
            <connectionSource class="ch.qos.logback.core.db.DriverManagerConnectionSource">
                <driverClass>oracle.jdbc.OracleDriver</driverClass>
                <url>jdbc:oracle:thin:@10.164.194.168:1521/haiercash</url>
                <user>appserver</user>
                <password>123456</password>
            </connectionSource>
        </appender>-->

    <appender name="ASYNC" class="ch.qos.logback.classic.AsyncAppender">
        <appender-ref ref="FILE"/>
        <queueSize>512</queueSize>
        <discardingThreshold>0</discardingThreshold>
    </appender>

    <appender name="VISIT_ASYNC" class="ch.qos.logback.classic.AsyncAppender">
        <appender-ref ref="VISIT_LOG"/>
        <queueSize>512</queueSize>
        <discardingThreshold>0</discardingThreshold>
    </appender>

    <appender name="STDOUT" class="ch.qos.logback.core.ConsoleAppender">
        <encoder>
            <pattern>%d{HH:mm:ss.SSS} %-5level %logger{36} - %msg%n</pattern>
        </encoder>
    </appender>

    <logger name="com.haiercash.appserver" level="debug">
        <!--<appender-ref ref="STDOUT"/>-->
        <appender-ref ref="ASYNC"/>
    </logger>

    <logger name="com.haiercash.commons.cmis.CmisUtil" level="debug">
        <!--<appender-ref ref="STDOUT"/>-->
        <appender-ref ref="ASYNC"/>
    </logger>

    <!--
         <logger name="com.haiercash.appserver.util.AsyncSignTask" level="debug">
             <appender-ref ref="STDOUT"/>
         </logger>

         <logger name="com.haiercash.appserver.util.XingeAsyncPushTask" level="debug">
             <appender-ref ref="STDOUT"/>
         </logger>-->

    <logger name="com.haiercash.commons.aop.RestActionInterceptor" level="info">
        <!--<appender-ref ref="STDOUT"/>-->
        <appender-ref ref="VISIT_ASYNC"/>
    </logger>

    <root level="error">
        <appender-ref ref="STDOUT"/>
        <!--<appender-ref ref="ERROR_LOG"/>-->
    </root>
</configuration>
