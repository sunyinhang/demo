<div data-container="demoCache">
    <component is="bv-form" :key="tags.formKey" v-bind="formConfig"></component>
</div>
<script type="text/javascript">
require(['jquery', 'util', 'Const', 'bvForm'], function($, util, Const) {
    var vm = util.bind({
        container: 'demoCache',
        data: {
            tags: {
                formKey: 'demoCacheForm'
            },
            formConfig: {
                layout: 'inline',
                columns: [
                    {
                        head: '手机号',
                        name: 'phoneNo',
                        config: {
                            attr: {
                                placeholder: '请输入手机号'
                            },
                            validate: {
                                required: '手机号不能为空'
                            }
                        }
                    }, {
                        head: '用户编号',
                        name: 'userId',
                        config: {
                            attr: {
                                placeholder: '请输入用户编号'
                            },
                            validate: {
                                required: '用户编号不能为空'
                            }
                        }
                    }, {
                        head: '客户编号',
                        name: 'custNo',
                        config: {
                            attr: {
                                placeholder: '请输入客户编号'
                            },
                            validate: {
                                required: '客户编号不能为空'
                            }
                        }
                    }
                ],
                operates: [
                    {
                        text: '保存',
                        clazz: 'primary',
                        click: function (event, editType, entity) {
                            util.post({
                                url: '/cache',
                                data: {
                                    type: 'set',
                                    params: 'phoneNo,userId,custNo',
                                    phoneNo: entity.phoneNo,
                                    userId: entity.userId,
                                    custNo: entity.custNo
                                },
                                success: function () {
                                    util.alert('成功');
                                }
                            });
                        }
                    }
                ]
            }
        },
        mounted: function () {
            util.post({
                url: '/cache',
                data: {
                    type: 'get',
                    params: 'phoneNo,userId,custNo'
                },
                success: function (res) {
                    util.refresh({
                        vm: util.vm(vm, vm.tags.formKey),
                        entity: util.data(res)
                    });
                }
            });
        }
    });
});
</script>